{
	"name": "PL_KHCDE_INV_OPT_HANA_EXTRACT_LOAD",
	"properties": {
		"description": "SAP HANA - Inventory Cost Optimization",
		"activities": [
			{
				"name": "CP_INV_OPT_HISTORICAL_CFR",
				"description": "INV_OPT_HISTORICAL_CFR - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": {
							"value": "SELECT REPLACE( \"BODIVView1\".\"CATEGORY\" , IFNULL(',', ''), IFNULL(' ', '')) ,  TO_VARCHAR(TO_DATE( \"BODIVView1\".\"GI_DATE\" ,'YYYY-MM-DD')) GI_DATE  ,  \"BODIVView1\".\"cse_act_shipped_qty\"  ,  \"BODIVView1\".\"cse_recoded_order_original\"  ,  \"BODIVView1\".\"SALESORG\"  ,  \"BODIVView1\".\"_BIC_ZMHIER04\" \nFROM \"_SYS_BIC\".\"kraft.SCM.Logistics_Reporting/CV_TIER2\" \"BODIVView1\"\n where GI_DATE>substr(add_months(current_date ,-6),1,10) and GI_DATE<=substr(current_date,1,10) and \"BODIVView1\".\"SALESORG\"  IN ('US01','US13','PR01')",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "GI_DATE",
									"type": "String"
								},
								"sink": {
									"name": "GI_DATE",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "REPLACE(CATEGORY,IFNULL(',',''),IFNULL(' ',''))",
									"type": "String"
								},
								"sink": {
									"name": "CATEGORY",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "cse_act_shipped_qty",
									"type": "Decimal"
								},
								"sink": {
									"name": "CSE_ACT_SHIPPED_QTY",
									"type": "Decimal"
								}
							},
							{
								"source": {
									"name": "cse_recoded_order_original",
									"type": "Decimal"
								},
								"sink": {
									"name": "CSE_RECODED_ORDER_ORIGINAL",
									"type": "Decimal"
								}
							},
							{
								"source": {
									"name": "SALESORG",
									"type": "String"
								},
								"sink": {
									"name": "SALESORG",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "_BIC_ZMHIER04",
									"type": "String"
								},
								"sink": {
									"name": "_BIC_ZMHIER04",
									"type": "String"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_HISTORICAL_CFR",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_FORECASTING",
				"description": "INV_OPT_FORECASTING - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": "SELECT  \"BODIVView1\".\"_BIC_ZBASECDE\"  BASE_CODE,  \"BODIVView1\".\"_BIC_ZFISCWEEK\"  FISCAL_WEEK,  \"BODIVView1\".\"_BIC_ZFINLPLAN\"  FINAL_CONSENSUS_FORECAST,  \"BODIVView1\".\"SHIPMENT_QTY\"  SHIPMENT_QTY,  \"BODIVView1\".\"CA_MATERIAL_NO_14\" MATERIAL_ID,  \"BODIVView1\".\"PLANT\"  IBL,  \"BODIVView1\".\"CM_ZFINLPLAN_CSE\"  FINAL_CONSENSUS_FORECAST_CSE\nFROM \"_SYS_BIC\".\"kraft.FTP.Loss_Prevention.Redeployment_SCL/CV_INV_OPT_FORECASTING_DATA\" \"BODIVView1\"\nwhere ( \"BODIVView1\".\"FISCYEAR\"  IS NOT NULL )",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "BASE_CODE",
									"type": "String"
								},
								"sink": {
									"name": "BASE_CODE",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "FISCAL_WEEK",
									"type": "String"
								},
								"sink": {
									"name": "FISCAL_WEEK",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "FINAL_CONSENSUS_FORECAST",
									"type": "Decimal"
								},
								"sink": {
									"name": "FINAL_CONSENSUS_FORECAST",
									"type": "Decimal"
								}
							},
							{
								"source": {
									"name": "SHIPMENT_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "SHIPMENT_QTY",
									"type": "Decimal"
								}
							},
							{
								"source": {
									"name": "MATERIAL_ID",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL_ID",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "IBL",
									"type": "String"
								},
								"sink": {
									"name": "IBL",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "FINAL_CONSENSUS_FORECAST_CSE",
									"type": "Decimal"
								},
								"sink": {
									"name": "FINAL_CONSENSUS_FORECAST_CSE",
									"type": "Decimal"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_FORECASTING",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_LOCATION_MASTER",
				"description": "INV_OPT_LOCATION_MASTER - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": "SELECT REPLACE(\"CITY\" , IFNULL(',', ''), IFNULL(' ', '')) CITY, \n REPLACE(\"CITY_POSTAL_CD\" , IFNULL(',', ''), IFNULL(' ', '')) CITY_POSTAL_CD,  \n\"ECC_LOC_TYPE\" ECC_LOC_TYPE, \"ECC_LOC_ID\" ECC_LOC_ID, \n REPLACE(\"ECC_LOC_DESC\" , IFNULL(',', ''), IFNULL(' ', '')) ECC_LOC_DESC,\n\"LOC_STATUS\" LOC_STATUS,\nREPLACE(\"LOC_STATUS_DESC\",IFNULL(',', ''), IFNULL(' ', '')) LOC_STATUS_DESC,\nREPLACE(\"LOC_TYPE\", IFNULL(',', ''), IFNULL(' ', '')) LOC_TYPE,\n\"LOCATION_SUB_INDICATOR\",\"STATE\",\nREPLACE(\"STREET\", IFNULL(',', ''), IFNULL(' ', '')) STREET,\"PLANT\",\nREPLACE(\"PLANT_TEXT\" , IFNULL(',', ''), IFNULL(' ', '')) PLANT_TEXT\nFROM \"_SYS_BIC\".\"kraft.SCM.Logistics_Reporting/CV_LOCATION_MASTER_CERT\" \"BODIVView3\"\n where (\"COUNTRY\"  = 'US')",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "CITY",
									"type": "String"
								},
								"sink": {
									"name": "CITY"
								}
							},
							{
								"source": {
									"name": "CITY_POSTAL_CD",
									"type": "String"
								},
								"sink": {
									"name": "CITY_POSTAL_CD"
								}
							},
							{
								"source": {
									"name": "ECC_LOC_TYPE",
									"type": "String"
								},
								"sink": {
									"name": "ECC_LOC_TYPE"
								}
							},
							{
								"source": {
									"name": "ECC_LOC_ID",
									"type": "String"
								},
								"sink": {
									"name": "ECC_LOC_ID"
								}
							},
							{
								"source": {
									"name": "ECC_LOC_DESC",
									"type": "String"
								},
								"sink": {
									"name": "ECC_LOC_DESC"
								}
							},
							{
								"source": {
									"name": "LOC_STATUS",
									"type": "String"
								},
								"sink": {
									"name": "LOC_STATUS"
								}
							},
							{
								"source": {
									"name": "LOC_STATUS_DESC",
									"type": "String"
								},
								"sink": {
									"name": "LOC_STATUS_DESC"
								}
							},
							{
								"source": {
									"name": "LOC_TYPE",
									"type": "String"
								},
								"sink": {
									"name": "LOC_TYPE"
								}
							},
							{
								"source": {
									"name": "LOCATION_SUB_INDICATOR",
									"type": "String"
								},
								"sink": {
									"name": "LOCATION_SUB_INDICATOR"
								}
							},
							{
								"source": {
									"name": "STATE",
									"type": "String"
								},
								"sink": {
									"name": "STATE"
								}
							},
							{
								"source": {
									"name": "STREET",
									"type": "String"
								},
								"sink": {
									"name": "STREET"
								}
							},
							{
								"source": {
									"name": "PLANT",
									"type": "String"
								},
								"sink": {
									"name": "PLANT"
								}
							},
							{
								"source": {
									"name": "PLANT_TEXT",
									"type": "String"
								},
								"sink": {
									"name": "PLANT_TEXT"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_LOCATION_MASTER",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_TRANS_DATA",
				"description": "INV_OPT_TRANS_DATA - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": "SELECT  \"VSBED\" SHIPPING_CONDITION,\"ALAND\" COUNTRY_ORIGIN,\"AZONE\" ORIGIN_FULL,\n\"LLAND\" COUNTRY_DESTINATION,\"LZONE\" DESTINATION_FULL,\"CA_AZONE_SC\" ORIGIN,\"CA_LZONE_SC\" DESTINATION,\"CA_ROUTE_3\" ESTIMATED_TRANSIT_DAYS\nFROM \"_SYS_BIC\".\"kraft.FTP.Loss_Prevention.Redeployment_SCL/CV_REDEPLOY_TRANS_DATA\"",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "SHIPPING_CONDITION",
									"type": "String"
								},
								"sink": {
									"name": "SHIPPING_CONDITION"
								}
							},
							{
								"source": {
									"name": "COUNTRY_ORIGIN",
									"type": "String"
								},
								"sink": {
									"name": "COUNTRY_ORIGIN"
								}
							},
							{
								"source": {
									"name": "ORIGIN_FULL",
									"type": "String"
								},
								"sink": {
									"name": "ORIGIN_FULL"
								}
							},
							{
								"source": {
									"name": "COUNTRY_DESTINATION",
									"type": "String"
								},
								"sink": {
									"name": "COUNTRY_DESTINATION"
								}
							},
							{
								"source": {
									"name": "DESTINATION_FULL",
									"type": "String"
								},
								"sink": {
									"name": "DESTINATION_FULL"
								}
							},
							{
								"source": {
									"name": "ORIGIN",
									"type": "String"
								},
								"sink": {
									"name": "ORIGIN"
								}
							},
							{
								"source": {
									"name": "DESTINATION",
									"type": "String"
								},
								"sink": {
									"name": "DESTINATION"
								}
							},
							{
								"source": {
									"name": "ESTIMATED_TRANSIT_DAYS",
									"type": "String"
								},
								"sink": {
									"name": "ESTIMATED_TRANSIT_DAYS"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_TRANS_DATA",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_PROJ_INVENTORY_LOSS",
				"description": "INV_OPT_PROJ_INVENTORY_LOSS - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": {
							"value": "SELECT \"MATERIAL_14\"  , \"LOCATION\"  , \"INVENTORY_DISPOSITION_CODE\"  , \"INVENTORY_DISPOSITION_CODE2\"  , \"INVENTORY_DISPOSITION_CODE3\"  , TO_VARCHAR(TO_DATE(\"CODE_DATE\",'YYYY-MM-DD')) CODE_DATE , TO_VARCHAR(TO_DATE( \"CUSTOMER_GUARANTEE\" ,'YYYY-MM-DD')) CUSTOMER_GUARANTEE , \"SHELF\"  , \"CODE_DATE_TYPE\"  , \"ITEM_FRESH_FRZN_CD\"  , \"INVENTORY_DISPOSITION_CODE_CONCAT\"  , \"CUST_GUAR_WEEKS_LEFT\"  , \"WEEKS_TO_EXPIRATION\"  , \"DAYS_TO_CUSTOMER_GUARANTEE\"  , \"DAYS_TO_EXPIRATION\"  , \"CUST_GUAR_DAYS_LEFT\"  , \"ONHAND_INV\"  , \"UNSOLD_QTY\"  , \"UNSOLD_PALLETS\"  , \"UNSOLD_NIC\"  , \"SHELF_LIFE_REMAINING_PER\" \nFROM \"_SYS_BIC\".\"kraft.SCM.Logistics_Reporting/CV_PROJINVLOSS_EXTRACTION_CERT\"",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "MATERIAL_14",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL_14"
								}
							},
							{
								"source": {
									"name": "LOCATION",
									"type": "String"
								},
								"sink": {
									"name": "LOCATION"
								}
							},
							{
								"source": {
									"name": "INVENTORY_DISPOSITION_CODE",
									"type": "String"
								},
								"sink": {
									"name": "INVENTORY_DISPOSITION_CODE"
								}
							},
							{
								"source": {
									"name": "INVENTORY_DISPOSITION_CODE2",
									"type": "String"
								},
								"sink": {
									"name": "INVENTORY_DISPOSITION_CODE2"
								}
							},
							{
								"source": {
									"name": "INVENTORY_DISPOSITION_CODE3",
									"type": "String"
								},
								"sink": {
									"name": "INVENTORY_DISPOSITION_CODE3"
								}
							},
							{
								"source": {
									"name": "CODE_DATE",
									"type": "String"
								},
								"sink": {
									"name": "CODE_DATE",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "CUSTOMER_GUARANTEE",
									"type": "String"
								},
								"sink": {
									"name": "CUSTOMER_GUARANTEE",
									"type": "String"
								}
							},
							{
								"source": {
									"name": "SHELF",
									"type": "Decimal"
								},
								"sink": {
									"name": "SHELF"
								}
							},
							{
								"source": {
									"name": "CODE_DATE_TYPE",
									"type": "String"
								},
								"sink": {
									"name": "CODE_DATE_TYPE"
								}
							},
							{
								"source": {
									"name": "ITEM_FRESH_FRZN_CD",
									"type": "String"
								},
								"sink": {
									"name": "ITEM_FRESH_FRZN_CD"
								}
							},
							{
								"source": {
									"name": "INVENTORY_DISPOSITION_CODE_CONCAT",
									"type": "String"
								},
								"sink": {
									"name": "INVENTORY_DISPOSITION_CODE_CONCAT"
								}
							},
							{
								"source": {
									"name": "CUST_GUAR_WEEKS_LEFT",
									"type": "Int32"
								},
								"sink": {
									"name": "CUST_GUAR_WEEKS_LEFT"
								}
							},
							{
								"source": {
									"name": "WEEKS_TO_EXPIRATION",
									"type": "Int32"
								},
								"sink": {
									"name": "WEEKS_TO_EXPIRATION"
								}
							},
							{
								"source": {
									"name": "DAYS_TO_CUSTOMER_GUARANTEE",
									"type": "Int32"
								},
								"sink": {
									"name": "DAYS_TO_CUSTOMER_GUARANTEE"
								}
							},
							{
								"source": {
									"name": "DAYS_TO_EXPIRATION",
									"type": "Int32"
								},
								"sink": {
									"name": "DAYS_TO_EXPIRATION"
								}
							},
							{
								"source": {
									"name": "CUST_GUAR_DAYS_LEFT",
									"type": "Int32"
								},
								"sink": {
									"name": "CUST_GUAR_DAYS_LEFT"
								}
							},
							{
								"source": {
									"name": "ONHAND_INV",
									"type": "Int32"
								},
								"sink": {
									"name": "ONHAND_INV"
								}
							},
							{
								"source": {
									"name": "UNSOLD_QTY",
									"type": "Int32"
								},
								"sink": {
									"name": "UNSOLD_QTY"
								}
							},
							{
								"source": {
									"name": "UNSOLD_PALLETS",
									"type": "Decimal"
								},
								"sink": {
									"name": "UNSOLD_PALLETS"
								}
							},
							{
								"source": {
									"name": "UNSOLD_NIC",
									"type": "Decimal"
								},
								"sink": {
									"name": "UNSOLD_NIC"
								}
							},
							{
								"source": {
									"name": "SHELF_LIFE_REMAINING_PER",
									"type": "Int32"
								},
								"sink": {
									"name": "SHELF_LIFE_REMAINING_PER"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_PROJ_INVENTORY_LOSS",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_NETWORK_MOVES",
				"description": "INV_OPT_NETWORK_MOVES - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": "SELECT \"MATNR\",\"WERKS\",\"DISMM\",\"BSTMI\",\"BSTMA\",\"MABST\",\"PERKZ\",\nREPLACE( \"SHZET\" , IFNULL(',', ''), IFNULL(' ', '')) SAFETY_TIME,\nREPLACE( \"YYPLANNER_VMI\" , IFNULL(',', ''), IFNULL(' ', '')) SNC_PLANNER,\nREPLACE( \"YYPHASE\" , IFNULL(',', ''), IFNULL(' ', '')) YYPHASE,\n\"MAABC\",\"YYMAXCOVDUR\" \nFROM \"_SYS_BIC\".\"kraft.FTP.Loss_Prevention.Redeployment_SCL/CV_INV_OPT_NETWORK\"\nwhere \"DISMM\"  IN ('ZD','X0','ZF')",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "MATNR",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL"
								}
							},
							{
								"source": {
									"name": "WERKS",
									"type": "String"
								},
								"sink": {
									"name": "PLANT"
								}
							},
							{
								"source": {
									"name": "DISMM",
									"type": "String"
								},
								"sink": {
									"name": "MRP_TYPE"
								}
							},
							{
								"source": {
									"name": "BSTMI",
									"type": "Decimal"
								},
								"sink": {
									"name": "MIN_LOT_SIZE"
								}
							},
							{
								"source": {
									"name": "BSTMA",
									"type": "Decimal"
								},
								"sink": {
									"name": "MAX_LOT_SIZE"
								}
							},
							{
								"source": {
									"name": "MABST",
									"type": "Decimal"
								},
								"sink": {
									"name": "MAX_STOCK_LEVEL"
								}
							},
							{
								"source": {
									"name": "PERKZ",
									"type": "String"
								},
								"sink": {
									"name": "PERIOD_INDICATOR"
								}
							},
							{
								"source": {
									"name": "SAFETY_TIME",
									"type": "String"
								},
								"sink": {
									"name": "SAFETY_TIME"
								}
							},
							{
								"source": {
									"name": "SNC_PLANNER",
									"type": "String"
								},
								"sink": {
									"name": "SNC_PLANNER"
								}
							},
							{
								"source": {
									"name": "YYPHASE",
									"type": "String"
								},
								"sink": {
									"name": "YYPHASE"
								}
							},
							{
								"source": {
									"name": "MAABC",
									"type": "String"
								},
								"sink": {
									"name": "ABC_INDICATOR"
								}
							},
							{
								"source": {
									"name": "YYMAXCOVDUR",
									"type": "Decimal"
								},
								"sink": {
									"name": "MAX_COVERAGE_DURATION"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_NETWORK_MOVES",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_MATERIAL_MASTER",
				"description": "INV_OPT_MATERIAL_MASTER - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": "SELECT  \"ABC_CLASS\", \nREPLACE( \"ABU_DESC\" , IFNULL(',', ''), IFNULL(' ', '')) ABU_DESC,\nREPLACE( \"ABU_ID\" , IFNULL(',', ''), IFNULL(' ', '')) ABU_ID,  \"BASE_UOM\",\nREPLACE( \"BU_EQUIVALENT_ID\" , IFNULL(',', ''), IFNULL(' ', '')) BU_EQUIVALENT_ID,\nREPLACE( \"CASE_CONFIGURATION_ID\" , IFNULL(',', ''), IFNULL(' ', '')) CASE_CONFIGURATION_ID,\nREPLACE( \"CASE_GTIN\" , IFNULL(',', ''), IFNULL(' ', '')) CASE_GTIN,  \"CASE_HT_QTY\",  \"CASE_LGTH_QTY\",  \"CASE_PALLET_LAYR\",  \"CASE_PALLET_QTY\",\nREPLACE( \"CASE_PER_MFG_STACK\" , IFNULL(',', ''), IFNULL(' ', '')) CASE_PER_MFG_STACK,  \"CASE_STACK_LIMIT\",  \"CASE_WDTH_QTY\",\nREPLACE( \"CATEGORY_DESC\" , IFNULL(',', ''), IFNULL(' ', '')) CATEGORY_DESC, REPLACE( \"CATEGORY_ID\" , IFNULL(',', ''), IFNULL(' ', '')) CATEGORY_ID,\n\"CD_DT_TP\",  \"CREATED_ON\",  \"CUBE_ADJUSTED_WT\",  \"CUBE_FT_CASE_QTY_D\",  \"DC_TO_CUST_WHSE\",  \"DIVISION_CD\",\nREPLACE( \"EPM_PLANNING_ID\" , IFNULL(',', ''), IFNULL(' ', '')) EPM_PLANNING_ID,  \"EXCL_FLAG_N\",  \"EXCL_FLAG_Y\",  \"FIRST_AVAILABLE_SHIP_DT\", \n\"FIXED_COST\",  \"GROSS_WT_CSE_QTY\", REPLACE( \"ITEM_FRESH_FRZN_CD\" , IFNULL(',', ''), IFNULL(' ', '')) ITEM_FRESH_FRZN_CD,  \"ITEM_TYPE_CD\",\n\"ITM_BSE_CD\",  \"ITM_CPTY_GRP_CD\",  \"KGF_STATUS\",  \"LAYER_PER_PLLT_QTY\",  \"LAYR_PER_MFG_STACK\",  \"LAYR_PER_MFG_STACK_OLD\",\nREPLACE( \"MANAGEMENT_GROUPING_ID\" , IFNULL(',', ''), IFNULL(' ', '')) MANAGEMENT_GROUPING_ID ,  \"MATERIAL\",  \"MATERIAL_14\", \nREPLACE( \"MATERIAL_TEXT\" , IFNULL(',', ''), IFNULL(' ', '')) MATERIAL_TEXT,  \"MATERIAL_STATUS\",  \"MFG_ID\",  \"MIN_DAYS\",  \n\"NET_WT_CSE_QTY\",  \"NIC\",  \"NPP_LD_GRP_6X\",  \"ORG_OF_OWNERSHIP\",  \"PACKAGE_CSE_QTY\",  \"PACKAGE_SIZE_QTY\",  \"PCT_SL\",  \n\"PLANT_TO_DC\",  \"PLLT_LAYR_HT_IN\",  \"PLLT_LAYR_WDTH_IN\",  \"PLLT_STACK_LIMIT\", REPLACE( \"PROD_TYPE_CD\" , IFNULL(',', ''), IFNULL(' ', '')) PROD_TYPE_CD, \nREPLACE( \"PRODUCT_FAMILY_ID\" , IFNULL(',', ''), IFNULL(' ', '')) PRODUCT_FAMILY_ID, REPLACE( \"PRODUCT_FAMILY_DESC\" , IFNULL(',', ''), IFNULL(' ', '')) PRODUCT_FAMILY_DESC,\nREPLACE( \"PRODUCT_TYPE_MDM\" , IFNULL(',', ''), IFNULL(' ', '')) PRODUCT_TYPE_MDM,  \"PROFIT_CENTER_ID\",  \"REPACK_INDICATOR\",  \"SAP_MATERIAL_TYPE\",  \"SHELF\",\nREPLACE( \"SIZE_ID\" , IFNULL(',', ''), IFNULL(' ', '')) SIZE_ID, REPLACE( \"SNP_PLANNER_DESK\" , IFNULL(',', ''), IFNULL(' ', '')) SNP_PLANNER_DESK, \n\"SUPPLY_PLANNER\",  \"SUPPLY_PLANNING_ANALYST\",  \"TEMP_CLASSIFICATION\",  \"TOTAL_COST\",  \"TRANS_COND_CD\",\nREPLACE( \"TRANS_COND_DESC\" , IFNULL(',', ''), IFNULL(' ', '')) TRANS_COND_DESC,  \"UDC_NFP_LD_GRP_ITM_6X\",  \"VARIABLE_COST\",  \"X_DIST_CHAIN_STATUS\",\n\"X_DIST_CHAIN_STATUS_VALID_FROM\", REPLACE( \"IT_FF_DESCRIPTION\" , IFNULL(',', ''), IFNULL(' ', '')) IT_FF_DESCRIPTION,  \"_BIC_ZTMPCLS\" \nFROM \"_SYS_BIC\".\"kraft.SCM.Logistics_Reporting/CV_PRODUCT_MASTER_CERT\" \"BODIVView7\"\nwhere ( \"SAP_MATERIAL_TYPE\"  = 'Z001')",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ABC_CLASS",
									"type": "String"
								},
								"sink": {
									"name": "ABC_CLASS"
								}
							},
							{
								"source": {
									"name": "ABU_DESC",
									"type": "String"
								},
								"sink": {
									"name": "ABU_DESC"
								}
							},
							{
								"source": {
									"name": "ABU_ID",
									"type": "String"
								},
								"sink": {
									"name": "ABU_ID"
								}
							},
							{
								"source": {
									"name": "BASE_UOM",
									"type": "String"
								},
								"sink": {
									"name": "BASE_UOM"
								}
							},
							{
								"source": {
									"name": "BU_EQUIVALENT_ID",
									"type": "String"
								},
								"sink": {
									"name": "BU_EQUIVALENT_ID"
								}
							},
							{
								"source": {
									"name": "CASE_CONFIGURATION_ID",
									"type": "String"
								},
								"sink": {
									"name": "CASE_CONFIGURATION_ID"
								}
							},
							{
								"source": {
									"name": "CASE_GTIN",
									"type": "String"
								},
								"sink": {
									"name": "CASE_GTIN"
								}
							},
							{
								"source": {
									"name": "CASE_HT_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "CASE_HT_QTY"
								}
							},
							{
								"source": {
									"name": "CASE_LGTH_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "CASE_LGTH_QTY"
								}
							},
							{
								"source": {
									"name": "CASE_PALLET_LAYR",
									"type": "Int32"
								},
								"sink": {
									"name": "CASE_PALLET_LAYR"
								}
							},
							{
								"source": {
									"name": "CASE_PALLET_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "CASE_PALLET_QTY"
								}
							},
							{
								"source": {
									"name": "CASE_PER_MFG_STACK",
									"type": "String"
								},
								"sink": {
									"name": "CASE_PER_MFG_STACK"
								}
							},
							{
								"source": {
									"name": "CASE_STACK_LIMIT",
									"type": "Int32"
								},
								"sink": {
									"name": "CASE_STACK_LIMIT"
								}
							},
							{
								"source": {
									"name": "CASE_WDTH_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "CASE_WDTH_QTY"
								}
							},
							{
								"source": {
									"name": "CATEGORY_DESC",
									"type": "String"
								},
								"sink": {
									"name": "CATEGORY_DESC"
								}
							},
							{
								"source": {
									"name": "CATEGORY_ID",
									"type": "String"
								},
								"sink": {
									"name": "CATEGORY_ID"
								}
							},
							{
								"source": {
									"name": "CD_DT_TP",
									"type": "String"
								},
								"sink": {
									"name": "CD_DT_TP"
								}
							},
							{
								"source": {
									"name": "CREATED_ON",
									"type": "String"
								},
								"sink": {
									"name": "CREATED_ON"
								}
							},
							{
								"source": {
									"name": "CUBE_ADJUSTED_WT",
									"type": "Decimal"
								},
								"sink": {
									"name": "CUBE_ADJUSTED_WT"
								}
							},
							{
								"source": {
									"name": "CUBE_FT_CASE_QTY_D",
									"type": "Decimal"
								},
								"sink": {
									"name": "CUBE_FT_CASE_QTY_D"
								}
							},
							{
								"source": {
									"name": "DC_TO_CUST_WHSE",
									"type": "Decimal"
								},
								"sink": {
									"name": "DC_TO_CUST_WHSE"
								}
							},
							{
								"source": {
									"name": "DIVISION_CD",
									"type": "String"
								},
								"sink": {
									"name": "DIVISION_CD"
								}
							},
							{
								"source": {
									"name": "EPM_PLANNING_ID",
									"type": "String"
								},
								"sink": {
									"name": "EPM_PLANNING_ID"
								}
							},
							{
								"source": {
									"name": "EXCL_FLAG_N",
									"type": "String"
								},
								"sink": {
									"name": "EXCL_FLAG_N"
								}
							},
							{
								"source": {
									"name": "EXCL_FLAG_Y",
									"type": "String"
								},
								"sink": {
									"name": "EXCL_FLAG_Y"
								}
							},
							{
								"source": {
									"name": "FIRST_AVAILABLE_SHIP_DT",
									"type": "String"
								},
								"sink": {
									"name": "FIRST_AVAILABLE_SHIP_DT"
								}
							},
							{
								"source": {
									"name": "FIXED_COST",
									"type": "Decimal"
								},
								"sink": {
									"name": "FIXED_COST"
								}
							},
							{
								"source": {
									"name": "GROSS_WT_CSE_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "GROSS_WT_CSE_QTY"
								}
							},
							{
								"source": {
									"name": "ITEM_FRESH_FRZN_CD",
									"type": "String"
								},
								"sink": {
									"name": "ITEM_FRESH_FRZN_CD"
								}
							},
							{
								"source": {
									"name": "ITEM_TYPE_CD",
									"type": "String"
								},
								"sink": {
									"name": "ITEM_TYPE_CD"
								}
							},
							{
								"source": {
									"name": "ITM_BSE_CD",
									"type": "String"
								},
								"sink": {
									"name": "ITM_BSE_CD"
								}
							},
							{
								"source": {
									"name": "ITM_CPTY_GRP_CD",
									"type": "String"
								},
								"sink": {
									"name": "ITM_CPTY_GRP_CD"
								}
							},
							{
								"source": {
									"name": "KGF_STATUS",
									"type": "String"
								},
								"sink": {
									"name": "KGF_STATUS"
								}
							},
							{
								"source": {
									"name": "LAYER_PER_PLLT_QTY",
									"type": "Int32"
								},
								"sink": {
									"name": "LAYER_PER_PLLT_QTY"
								}
							},
							{
								"source": {
									"name": "LAYR_PER_MFG_STACK",
									"type": "Int32"
								},
								"sink": {
									"name": "LAYR_PER_MFG_STACK"
								}
							},
							{
								"source": {
									"name": "LAYR_PER_MFG_STACK_OLD",
									"type": "Decimal"
								},
								"sink": {
									"name": "LAYR_PER_MFG_STACK_OLD"
								}
							},
							{
								"source": {
									"name": "MANAGEMENT_GROUPING_ID",
									"type": "String"
								},
								"sink": {
									"name": "MANAGEMENT_GROUPING_ID"
								}
							},
							{
								"source": {
									"name": "MATERIAL",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL"
								}
							},
							{
								"source": {
									"name": "MATERIAL_14",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL_14"
								}
							},
							{
								"source": {
									"name": "MATERIAL_TEXT",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL_TEXT"
								}
							},
							{
								"source": {
									"name": "MATERIAL_STATUS",
									"type": "String"
								},
								"sink": {
									"name": "MATERIAL_STATUS"
								}
							},
							{
								"source": {
									"name": "MFG_ID",
									"type": "String"
								},
								"sink": {
									"name": "MFG_ID"
								}
							},
							{
								"source": {
									"name": "MIN_DAYS",
									"type": "Decimal"
								},
								"sink": {
									"name": "MIN_DAYS"
								}
							},
							{
								"source": {
									"name": "NET_WT_CSE_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "NET_WT_CSE_QTY"
								}
							},
							{
								"source": {
									"name": "NIC",
									"type": "Decimal"
								},
								"sink": {
									"name": "NIC"
								}
							},
							{
								"source": {
									"name": "NPP_LD_GRP_6X",
									"type": "String"
								},
								"sink": {
									"name": "NPP_LD_GRP_6X"
								}
							},
							{
								"source": {
									"name": "ORG_OF_OWNERSHIP",
									"type": "String"
								},
								"sink": {
									"name": "ORG_OF_OWNERSHIP"
								}
							},
							{
								"source": {
									"name": "PACKAGE_CSE_QTY",
									"type": "Int32"
								},
								"sink": {
									"name": "PACKAGE_CSE_QTY"
								}
							},
							{
								"source": {
									"name": "PACKAGE_SIZE_QTY",
									"type": "Decimal"
								},
								"sink": {
									"name": "PACKAGE_SIZE_QTY"
								}
							},
							{
								"source": {
									"name": "PCT_SL",
									"type": "Int32"
								},
								"sink": {
									"name": "PCT_SL"
								}
							},
							{
								"source": {
									"name": "PLANT_TO_DC",
									"type": "Decimal"
								},
								"sink": {
									"name": "PLANT_TO_DC"
								}
							},
							{
								"source": {
									"name": "PLLT_LAYR_HT_IN",
									"type": "Decimal"
								},
								"sink": {
									"name": "PLLT_LAYR_HT_IN"
								}
							},
							{
								"source": {
									"name": "PLLT_LAYR_WDTH_IN",
									"type": "Decimal"
								},
								"sink": {
									"name": "PLLT_LAYR_WDTH_IN"
								}
							},
							{
								"source": {
									"name": "PLLT_STACK_LIMIT",
									"type": "Int32"
								},
								"sink": {
									"name": "PLLT_STACK_LIMIT"
								}
							},
							{
								"source": {
									"name": "PROD_TYPE_CD",
									"type": "String"
								},
								"sink": {
									"name": "PROD_TYPE_CD"
								}
							},
							{
								"source": {
									"name": "PRODUCT_FAMILY_ID",
									"type": "String"
								},
								"sink": {
									"name": "PRODUCT_FAMILY_ID"
								}
							},
							{
								"source": {
									"name": "PRODUCT_FAMILY_DESC",
									"type": "String"
								},
								"sink": {
									"name": "PRODUCT_FAMILY_DESC"
								}
							},
							{
								"source": {
									"name": "PRODUCT_TYPE_MDM",
									"type": "String"
								},
								"sink": {
									"name": "PRODUCT_TYPE_MDM"
								}
							},
							{
								"source": {
									"name": "PROFIT_CENTER_ID",
									"type": "String"
								},
								"sink": {
									"name": "PROFIT_CENTER_ID"
								}
							},
							{
								"source": {
									"name": "REPACK_INDICATOR",
									"type": "String"
								},
								"sink": {
									"name": "REPACK_INDICATOR"
								}
							},
							{
								"source": {
									"name": "SAP_MATERIAL_TYPE",
									"type": "String"
								},
								"sink": {
									"name": "SAP_MATERIAL_TYPE"
								}
							},
							{
								"source": {
									"name": "SHELF",
									"type": "Decimal"
								},
								"sink": {
									"name": "SHELF"
								}
							},
							{
								"source": {
									"name": "SIZE_ID",
									"type": "String"
								},
								"sink": {
									"name": "SIZE_ID"
								}
							},
							{
								"source": {
									"name": "SNP_PLANNER_DESK",
									"type": "String"
								},
								"sink": {
									"name": "SNP_PLANNER_DESK"
								}
							},
							{
								"source": {
									"name": "SUPPLY_PLANNER",
									"type": "String"
								},
								"sink": {
									"name": "SUPPLY_PLANNER"
								}
							},
							{
								"source": {
									"name": "SUPPLY_PLANNING_ANALYST",
									"type": "String"
								},
								"sink": {
									"name": "SUPPLY_PLANNING_ANALYST"
								}
							},
							{
								"source": {
									"name": "TEMP_CLASSIFICATION",
									"type": "String"
								},
								"sink": {
									"name": "TEMP_CLASSIFICATION"
								}
							},
							{
								"source": {
									"name": "TOTAL_COST",
									"type": "Decimal"
								},
								"sink": {
									"name": "TOTAL_COST"
								}
							},
							{
								"source": {
									"name": "TRANS_COND_CD",
									"type": "String"
								},
								"sink": {
									"name": "TRANS_COND_CD"
								}
							},
							{
								"source": {
									"name": "TRANS_COND_DESC",
									"type": "String"
								},
								"sink": {
									"name": "TRANS_COND_DESC"
								}
							},
							{
								"source": {
									"name": "UDC_NFP_LD_GRP_ITM_6X",
									"type": "String"
								},
								"sink": {
									"name": "UDC_NFP_LD_GRP_ITM_6X"
								}
							},
							{
								"source": {
									"name": "VARIABLE_COST",
									"type": "Decimal"
								},
								"sink": {
									"name": "VARIABLE_COST"
								}
							},
							{
								"source": {
									"name": "X_DIST_CHAIN_STATUS",
									"type": "String"
								},
								"sink": {
									"name": "X_DIST_CHAIN_STATUS"
								}
							},
							{
								"source": {
									"name": "X_DIST_CHAIN_STATUS_VALID_FROM",
									"type": "String"
								},
								"sink": {
									"name": "X_DIST_CHAIN_STATUS_VALID_FROM"
								}
							},
							{
								"source": {
									"name": "IT_FF_DESCRIPTION",
									"type": "String"
								},
								"sink": {
									"name": "IT_FF_DESCRIPTION"
								}
							},
							{
								"source": {
									"name": "_BIC_ZTMPCLS",
									"type": "String"
								},
								"sink": {
									"name": "_BIC_ZTMPCLS"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_MATERIAL_MASTER",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_DEMONSTRATED_RATES",
				"description": "INV_OPT_DEMONSTRATED_RATES - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": {
							"value": "SELECT  RATES.\"_BIC_ZFISCPER\",  \nRATES.\"_BIC_ZFISCWEEK\",  \nRATES.\"MBOL\",  \nRATES.\"MODE\",\nRATES.\"ORIGIN\",  \nRATES.\"DESTINATION\",  \nRATES.\"PROTECTION_CLASS\",  \nRATES.\"_BIC_ZSHPMILES\",  \nRATES.\"TOT_SPEND\"\nFROM \"_SYS_BIC\".\"kraft.SCM.Trans/CV_TA_T1_DATA\" RATES,\n(select CALENDER_DATE,FISCAL_WEEK END_FISCAL_WEEK,FISCAL_PERIOD,\n(Case\nwhen (cast(substr(FISCAL_WEEK,5,3) as INTEGER)-26) < 0 then\nCONCAT(cast(cast(substr(FISCAL_WEEK,1,4) as INTEGER)-1 as VARCHAR),cast(lpad(52+cast(substr(FISCAL_WEEK,5,3) as INTEGER)-26,3,0) as VARCHAR))\nwhen (cast(substr(FISCAL_WEEK,5,3) as INTEGER)-26) = 0 then\nCONCAT(cast(cast(substr(FISCAL_WEEK,1,4) as INTEGER) as VARCHAR),'001')\nelse CONCAT(substr(FISCAL_WEEK,1,4),cast(lpad(cast(substr(FISCAL_WEEK,5,3)as INTEGER)-26,3,0) as VARCHAR))\nEND) START_FISCAL_WEEK\nfrom \"SAPBWP\".\"YBW_FISCAL_DET\" CALTABLE\nwhere CALENDER_DATE=TO_VARCHAR(TO_DATE(CURRENT_DATE),'YYYYMMDD')) CALTAB\nwhere ( RATES.\"COUNTRY\"  = 'US') and ( RATES.\"MODE\"  <> 'LTL')\nand cast(RATES.\"_BIC_ZFISCWEEK\" as INTEGER)>cast(CALTAB.START_FISCAL_WEEK as INTEGER)\nand cast(RATES.\"_BIC_ZFISCWEEK\" as INTEGER)<=cast(CALTAB.END_FISCAL_WEEK as INTEGER)",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "_BIC_ZFISCPER",
									"type": "String"
								},
								"sink": {
									"name": "_BIC_ZFISCPER"
								}
							},
							{
								"source": {
									"name": "_BIC_ZFISCWEEK",
									"type": "String"
								},
								"sink": {
									"name": "_BIC_ZFISCWEEK"
								}
							},
							{
								"source": {
									"name": "MBOL",
									"type": "String"
								},
								"sink": {
									"name": "MBOL"
								}
							},
							{
								"source": {
									"name": "MODE",
									"type": "String"
								},
								"sink": {
									"name": "MODE"
								}
							},
							{
								"source": {
									"name": "ORIGIN",
									"type": "String"
								},
								"sink": {
									"name": "ORIGIN"
								}
							},
							{
								"source": {
									"name": "DESTINATION",
									"type": "String"
								},
								"sink": {
									"name": "DESTINATION"
								}
							},
							{
								"source": {
									"name": "PROTECTION_CLASS",
									"type": "String"
								},
								"sink": {
									"name": "PROTECTION_CLASS"
								}
							},
							{
								"source": {
									"name": "_BIC_ZSHPMILES",
									"type": "Int32"
								},
								"sink": {
									"name": "_BIC_ZSHPMILES"
								}
							},
							{
								"source": {
									"name": "TOT_SPEND",
									"type": "Double"
								},
								"sink": {
									"name": "TOT_SPEND"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_DEMONSTRATED_RATES",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "CP_INV_OPT_PLANNING_BOOK_DATA_DLY",
				"description": "INV_OPT_PLANNING_BOOK_DATA_DLY - Extract",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SapHanaSource",
						"query": {
							"value": "SELECT  \"_BIC_ZADFCST\" FORECAST,\n\"_BIC_ZSALE_ORD\" SALES_ORDER,\n\"_BIC_ZDST_DMD\" DIST_DEMAND_CONF,\n\"_BIC_ZDPDNT_DM\" DEPENDENT_DEMAND,\n\"_BIC_ZADMDDT\" DISTRIBUTION_DEMAND_PO_STO,\n\"CM_TOTAL_DEMAND\" CM_TOTAL_DEMAND,\n\"_BIC_ZAFSHIP\" DIST_RECEIPT_CONF,\n\"_BIC_ZAITRAN\" IN_TRANSIT,\n\"_BIC_ZATSHIP\" DIST_RECEIPT_PO_STO,\n\"CM_TOTAL_RECEIPTS\" CM_TOTAL_RECEIPTS,\n\"_BIC_ZSUB_CDMD\" SUBS_DEMAND_CONF,\n\"_BIC_ZAPSUBAB\" SUBS_DEMAND_PLAN,\n\"_BIC_ZPROD_CON\" PRODUCTION_CONFD,\n\"_BIC_ZAPPROD\" PRODUCTION_PLANNED_QUANTITY,\n\"_BIC_ZPRDSBC\" PRODUCTION_SC_PLANNED,\n\"_BIC_ZCST_WPRJ\" PROJ_WASTAGE,\nTO_VARCHAR(TO_DATE( \"CALDAY\" ,'YYYYMMDD')) CAL_DATE, \n\"_BIC_ZFISCWEEK\" FISCAL_WEEK,\n\"MATERIAL\" MATERIAL,\n\"PLANT\" PLANT,\n\"UNIT\" UNIT,\n\"_BIC_ZDST_PDMD\" DIST_DEMAND_PLND,\n\"_BIC_ZAPSHIP\" DIST_RECEIPT_PLND,\n\"_BIC_ZTGT_LVL\" TARGET_STOCK_LEVEL,\n\"_BIC_ZMS_UPLIM\" MAX_STOCK_LEVEL,\n\"_BIC_ZCST_PRS\" PROJECTED_STOCK\nFROM \"_SYS_BIC\".\"kraft.FTP.Loss_Prevention.Redeployment_SCL/CV_INV_OPT_PLANNING_BOOK_DLY\"\nwhere (TO_VARCHAR(TO_DATE(\"CALDAY\" ,'YYYYMMDD')) >= TO_VARCHAR(TO_DATE( \"CA_CURR_YR_DT_MM\" ,'YYYYMMDD'))) \nand (TO_VARCHAR(TO_DATE(\"CALDAY\" ,'YYYYMMDD')) <= TO_VARCHAR(TO_DATE( \"CA_FORECAST_DT_YR_MM\" ,'YYYYMMDD')))",
							"type": "Expression"
						},
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "FORECAST"
								},
								"sink": {
									"name": "FORECAST"
								}
							},
							{
								"source": {
									"name": "SALES_ORDER"
								},
								"sink": {
									"name": "SALES_ORDER"
								}
							},
							{
								"source": {
									"name": "DIST_DEMAND_CONF"
								},
								"sink": {
									"name": "DIST_DEMAND_CONF"
								}
							},
							{
								"source": {
									"name": "DEPENDENT_DEMAND"
								},
								"sink": {
									"name": "DEPENDENT_DEMAND"
								}
							},
							{
								"source": {
									"name": "DISTRIBUTION_DEMAND_PO_STO"
								},
								"sink": {
									"name": "DISTRIBUTION_DEMAND_PO_STO"
								}
							},
							{
								"source": {
									"name": "CM_TOTAL_DEMAND"
								},
								"sink": {
									"name": "CM_TOTAL_DEMAND"
								}
							},
							{
								"source": {
									"name": "DIST_RECEIPT_CONF"
								},
								"sink": {
									"name": "DIST_RECEIPT_CONF"
								}
							},
							{
								"source": {
									"name": "IN_TRANSIT"
								},
								"sink": {
									"name": "IN_TRANSIT"
								}
							},
							{
								"source": {
									"name": "DIST_RECEIPT_PO_STO"
								},
								"sink": {
									"name": "DIST_RECEIPT_PO_STO"
								}
							},
							{
								"source": {
									"name": "CM_TOTAL_RECEIPTS"
								},
								"sink": {
									"name": "CM_TOTAL_RECEIPTS"
								}
							},
							{
								"source": {
									"name": "SUBS_DEMAND_CONF"
								},
								"sink": {
									"name": "SUBS_DEMAND_CONF"
								}
							},
							{
								"source": {
									"name": "SUBS_DEMAND_PLAN"
								},
								"sink": {
									"name": "SUBS_DEMAND_PLAN"
								}
							},
							{
								"source": {
									"name": "PRODUCTION_CONFD"
								},
								"sink": {
									"name": "PRODUCTION_CONFD"
								}
							},
							{
								"source": {
									"name": "PRODUCTION_PLANNED_QUANTITY"
								},
								"sink": {
									"name": "PRODUCTION_PLANNED_QUANTITY"
								}
							},
							{
								"source": {
									"name": "PRODUCTION_SC_PLANNED"
								},
								"sink": {
									"name": "PRODUCTION_SC_PLANNED"
								}
							},
							{
								"source": {
									"name": "PROJ_WASTAGE"
								},
								"sink": {
									"name": "PROJ_WASTAGE"
								}
							},
							{
								"source": {
									"name": "CAL_DATE"
								},
								"sink": {
									"name": "CAL_DATE"
								}
							},
							{
								"source": {
									"name": "FISCAL_WEEK"
								},
								"sink": {
									"name": "FISCAL_WEEK"
								}
							},
							{
								"source": {
									"name": "MATERIAL"
								},
								"sink": {
									"name": "MATERIAL"
								}
							},
							{
								"source": {
									"name": "PLANT"
								},
								"sink": {
									"name": "PLANT"
								}
							},
							{
								"source": {
									"name": "UNIT"
								},
								"sink": {
									"name": "UNIT"
								}
							},
							{
								"source": {
									"name": "DIST_DEMAND_PLND"
								},
								"sink": {
									"name": "DIST_DEMAND_PLND"
								}
							},
							{
								"source": {
									"name": "DIST_RECEIPT_PLND"
								},
								"sink": {
									"name": "DIST_RECEIPT_PLND"
								}
							},
							{
								"source": {
									"name": "TARGET_STOCK_LEVEL"
								},
								"sink": {
									"name": "TARGET_STOCK_LEVEL"
								}
							},
							{
								"source": {
									"name": "MAX_STOCK_LEVEL"
								},
								"sink": {
									"name": "MAX_STOCK_LEVEL"
								}
							},
							{
								"source": {
									"name": "PROJECTED_STOCK"
								},
								"sink": {
									"name": "PROJECTED_STOCK"
								}
							}
						]
					}
				},
				"inputs": [
					{
						"referenceName": "DS_INV_OPT_SAP_HANA_DATA",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_INV_OPT_PLANNING_BOOK_DATA_DLY",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "SP-PipelineStart_Master",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_pipeline_audit_log]",
					"storedProcedureParameters": {
						"action_ind": {
							"value": {
								"value": "I",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": "inventory_optimization",
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_name": {
							"value": {
								"value": "@{pipeline().Pipeline}",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_status": {
							"value": {
								"value": "Processing",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed01",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "If_folder_exists_then_delete",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "If_folder_exists_then_delete",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-PipelineSuccessful_Master",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_HISTORICAL_CFR",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_FORECASTING",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_LOCATION_MASTER",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_TRANS_DATA",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_PROJ_INVENTORY_LOSS",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_NETWORK_MOVES",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_MATERIAL_MASTER",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_DEMONSTRATED_RATES",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "CP_INV_OPT_PLANNING_BOOK_DATA_DLY",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_pipeline_audit_log]",
					"storedProcedureParameters": {
						"action_ind": {
							"value": {
								"value": "U",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_name": {
							"value": {
								"value": "@{pipeline().Pipeline}",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_status": {
							"value": {
								"value": "Successful",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_01",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_HISTORICAL_CFR",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_HISTORICAL_CFR",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_02",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_FORECASTING",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_FORECASTING",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_03",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_LOCATION_MASTER",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_LOCATION_MASTER",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_04",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_TRANS_DATA",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_TRANS_DATA",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_05",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_PROJ_INVENTORY_LOSS",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_PROJ_INVENTORY_LOSS",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_06",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_NETWORK_MOVES",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_NETWORK_MOVES",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_07",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_MATERIAL_MASTER",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_MATERIAL_MASTER",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_08",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_DEMONSTRATED_RATES",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_DEMONSTRATED_RATES",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "SP-ActivityAndPipelineFailed02_09",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "CP_INV_OPT_PLANNING_BOOK_DATA_DLY",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
					"storedProcedureParameters": {
						"activity_name": {
							"value": {
								"value": "CP_INV_OPT_PLANNING_BOOK_DATA_DLY",
								"type": "Expression"
							},
							"type": "String"
						},
						"activity_status": {
							"value": {
								"value": "Failed",
								"type": "Expression"
							},
							"type": "String"
						},
						"application_name": {
							"value": {
								"value": "inventory_optimization",
								"type": "Expression"
							},
							"type": "String"
						},
						"dataset_name": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_code": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"error_detail": {
							"value": {
								"value": "N.A.",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipeline_run_id": {
							"value": {
								"value": "@{pipeline().RunId}",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SQL",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "Get_Metadata_if_Folder_exists",
				"description": "Get metadata details if stage folder exists.",
				"type": "GetMetadata",
				"dependsOn": [
					{
						"activity": "SP-PipelineStart_Master",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataset": {
						"referenceName": "DS_INV_OPT_RAW_FILES",
						"type": "DatasetReference"
					},
					"fieldList": [
						"exists",
						"itemType",
						"childItems"
					],
					"storeSettings": {
						"type": "AzureBlobFSReadSettings",
						"recursive": true
					},
					"formatSettings": {
						"type": "DelimitedTextReadSettings"
					}
				}
			},
			{
				"name": "If_folder_exists_then_delete",
				"description": "Checking if stage folder is exists .If It is exists then delete otherwise do not do anything.",
				"type": "IfCondition",
				"dependsOn": [
					{
						"activity": "Get_Metadata_if_Folder_exists",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"userProperties": [],
				"typeProperties": {
					"expression": {
						"value": "@activity('Get_Metadata_if_Folder_exists').output.exists",
						"type": "Expression"
					},
					"ifTrueActivities": [
						{
							"name": "DELETE_FILES_FROM_RAW",
							"description": "Delete files from Blob Location Before Importing new files",
							"type": "Delete",
							"dependsOn": [],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"typeProperties": {
								"dataset": {
									"referenceName": "DS_INV_OPT_RAW_FILES",
									"type": "DatasetReference"
								},
								"enableLogging": false,
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"wildcardFileName": "*.csv"
								}
							}
						},
						{
							"name": "SP-ActivityAndPipelineFailed01_01",
							"type": "SqlServerStoredProcedure",
							"dependsOn": [
								{
									"activity": "DELETE_FILES_FROM_RAW",
									"dependencyConditions": [
										"Failed"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"typeProperties": {
								"storedProcedureName": "[dbo].[generic_activity_error_audit_log]",
								"storedProcedureParameters": {
									"activity_name": {
										"value": {
											"value": "DELETE_FILES_FROM_RAW",
											"type": "Expression"
										},
										"type": "String"
									},
									"activity_status": {
										"value": {
											"value": "Failed",
											"type": "Expression"
										},
										"type": "String"
									},
									"application_name": {
										"value": {
											"value": "inventory_optimization",
											"type": "Expression"
										},
										"type": "String"
									},
									"dataset_name": {
										"value": {
											"value": "N.A.",
											"type": "Expression"
										},
										"type": "String"
									},
									"error_code": {
										"value": {
											"value": "N.A.",
											"type": "Expression"
										},
										"type": "String"
									},
									"error_detail": {
										"value": {
											"value": "N.A.",
											"type": "Expression"
										},
										"type": "String"
									},
									"pipeline_run_id": {
										"value": {
											"value": "@{pipeline().RunId}",
											"type": "Expression"
										},
										"type": "String"
									}
								}
							},
							"linkedServiceName": {
								"referenceName": "LS_SQL",
								"type": "LinkedServiceReference"
							}
						}
					]
				}
			}
		],
		"folder": {
			"name": "Inventory_Optimization/sub_pipelines"
		},
		"annotations": []
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}